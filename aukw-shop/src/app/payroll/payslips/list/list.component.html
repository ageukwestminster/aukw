<h2>Payroll Drill-down</h2>

<div
  class="d-flex flex-row justify-content-between"
  *ngIf="total && total.totalPay"
>
  <div class="p-2">
    <p>{{ this.payslips.length }} employees</p>
  </div>
  <div class="p-2">
    <p>
      Payroll Date:
      {{ this.payslips[0].payrollDate | date: "dd MMM yyyy" }}
    </p>
  </div>
  <div class="p-2">
    <p>
      Total pension payment:
      {{
        total.salarySacrifice + total.employeePension + total.employerPension
          | number: "1.2-2"
      }}
    </p>
  </div>
</div>
<table class="table table-striped table-responsive">
  <thead>
    <tr>
      <th style="width: 5%">No.</th>
      <th style="width: 22%">Name</th>
      <th style="width: 8%">Gross</th>
      <th style="width: 8%" class="d-none d-sm-table-cell">PAYE</th>
      <th style="width: 8%" class="d-none d-sm-table-cell">E'ee NI</th>
      <th style="width: 6%" class="d-none d-sm-table-cell">Other</th>
      <th style="width: 8%" class="d-none d-sm-table-cell">S Sac</th>
      <th style="width: 8%" class="d-none d-sm-table-cell">St Loan</th>
      <th style="width: 8%" class="d-none d-sm-table-cell">Net</th>
      <th style="width: 8%" class="d-none d-sm-table-cell">E'er NI</th>
      <th class="text-center" style="width: 8%">In QBO?</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let payslip of payslips$ | async">
      <td style="vertical-align: middle">
        {{ payslip.payrollNumber }}
      </td>
      <td>{{ payslip.employeeName }}</td>
      <td>{{ payslip.totalPay | number: "1.2-2" }}</td>
      <td class="d-none d-sm-table-cell">
        {{ payslip.paye | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ payslip.employeeNI | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ payslip.otherDeductions | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{
          -payslip.salarySacrifice - payslip.employeePension | number: "1.2-2"
        }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ payslip.studentLoan | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ payslip.netPay | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ payslip.employerNI | number: "1.2-2" }}
      </td>
      <td class="text-center">
        <div class="row">
          <div class="col">
            <i
              class="fas fa-minus"
              *ngIf="!payslip.employerNI"
              ngbTooltip="Employer NI is zero."
            ></i>
            <span style="color: green">
              <i
                class="fas fa-check"
                *ngIf="payslip.employerNI && payslip.niJournalInQBO"
                ngbTooltip="Employer NI journal done."
              ></i>
            </span>
            <span style="color: red">
              <i
                class="fas fa-times"
                *ngIf="payslip.employerNI && !payslip.niJournalInQBO"
                ngbTooltip="Employer NI journal missing."
              ></i>
            </span>
          </div>
          <div class="col">
            <span style="color: green">
              <i
                class="fas fa-check"
                *ngIf="payslip.payslipJournalInQBO"
                ngbTooltip="Employee payslip GJ done."
              ></i>
            </span>
            <span style="color: red">
              <i
                class="fas fa-times"
                *ngIf="!payslip.payslipJournalInQBO"
                ngbTooltip="Employee payslip GJ missing."
              ></i>
            </span>
          </div>
          <div class="col">
            <i
              class="fas fa-minus"
              *ngIf="!payslip.employerPension"
              ngbTooltip="Not in pension plan."
            ></i>
            <span style="color: green">
              <i
                class="fas fa-check"
                *ngIf="payslip.employerPension && payslip.pensionBillInQBO"
                ngbTooltip="L&G pension bill done."
              ></i>
            </span>
            <span style="color: red">
              <i
                class="fas fa-times"
                *ngIf="payslip.employerPension && !payslip.pensionBillInQBO"
                ngbTooltip="L&G pension bill missing."
              ></i>
            </span>
          </div>
          <div class="col">
            <i
              class="fas fa-minus"
              *ngIf="!payslip.isShopEmployee"
              ngbTooltip="Not a shop employee."
            ></i>
            <span style="color: green">
              <i
                class="fas fa-check"
                *ngIf="payslip.shopJournalInQBO"
                ngbTooltip="Shop journal entry done."
              ></i>
            </span>
            <span style="color: red">
              <i
                class="fas fa-times"
                *ngIf="payslip.isShopEmployee && !payslip.shopJournalInQBO"
                ngbTooltip="Shop journal entry missing."
              ></i>
            </span>
          </div>
        </div>
      </td>
    </tr>
    <tr *ngIf="total && total.totalPay" style="font-weight: bold">
      <td></td>
      <td>Total for {{ this.payslips.length }} employees:</td>
      <td>{{ total.totalPay | number: "1.2-2" }}</td>
      <td class="d-none d-sm-table-cell">
        {{ total.paye | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ total.employeeNI | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ total.otherDeductions | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ -total.salarySacrifice - total.employeePension | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ total.studentLoan | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ total.netPay | number: "1.2-2" }}
      </td>
      <td class="d-none d-sm-table-cell">
        {{ total.employerNI | number: "1.2-2" }}
      </td>
      <td></td>
    </tr>
    <tr *ngIf="!payslips">
      <td colspan="13" class="text-center">
        <span class="spinner-border spinner-border-lg align-center"></span>
      </td>
    </tr>
  </tbody>
</table>
